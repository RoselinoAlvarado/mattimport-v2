<app-header [isModal]="isTrue" [title]="titleName"></app-header>

<ion-content>
  <form
    [formGroup]="form"
    class="ion-padding ion-text-center"
    (ngSubmit)="submit()"
    (keypress.enter)="submit()"
  >
    <ion-avatar *ngIf="form.value.image">
      <img [src]="form.value.image" alt="Product img"/>
    </ion-avatar>

    <ion-icon class="image-icon" *ngIf="!form.value.image" name="image-outline"></ion-icon>

    <br>

    <ion-button (click)="takeImage()" mode="ios" size="small" shape="round">
      {{imageLabel}}
    </ion-button>

    <ion-item *ngIf="!product" class="custom-input" lines="none">
      <ion-select fill="clear" formControlName="client" label="Cliente">
        <ion-select-option *ngFor="let clientData of clientsData" [value]="clientData.id">
          {{ clientData.name }}
        </ion-select-option>
      </ion-select>
      <div
        class="validator"
        *ngIf="form.controls.client.errors && form.controls.client.touched"
      >
        <div *ngIf="form.controls.client.errors?.['required']">
          O cliente é requerido
        </div>
      </div>
    </ion-item>


    <app-custom-input
      [control]="form.controls.productName"
      type="text"
      [label]="nameLabel"
    ></app-custom-input>
    <div
      class="validator"
      *ngIf="
        form.controls.productName.errors && form.controls.productName.touched
      "
    >
      <div *ngIf="form.controls.productName.errors?.['required']">
        O nome é requerido
      </div>
      <div *ngIf="form.controls.productName.errors?.['minLenght']">
        O nome deve conter um mínimo de quatro caráteres
      </div>
    </div>

    <app-custom-input
      [control]="form.controls.value"
      type="number"
      [label]="valueLabel"
    ></app-custom-input>
    <div
      class="validator"
      *ngIf="form.controls.value.errors && form.controls.value.touched"
    >
      <div *ngIf="form.controls.value.errors?.['required']">
        O preço é requerido
      </div>
      <div *ngIf="form.controls.value.errors?.['min']">
        O preço mínimo deve ser mior que 0
      </div>
    </div>

    <ion-item *ngIf="!product" class="custom-input" lines="none">
      <ion-select fill="clear" formControlName="parcel" label="Parcelas">
        <ion-select-option
          *ngFor="let parcelOption of parcelOptions"
          [value]="parcelOption.value"
          >{{ parcelOption.label }}</ion-select-option
        >
      </ion-select>
      <div
        class="validator"
        *ngIf="form.controls.parcel.errors && form.controls.parcel.touched"
      >
        <div *ngIf="form.controls.parcel.errors?.['required']">
          A parcela é requerida
        </div>
      </div>
    </ion-item>

    <app-custom-input
      [control]="form.controls.paymentDate"
      type="date"
      [label]="dateLabel"
    ></app-custom-input>
    <div
      class="validator"
      *ngIf="
        form.controls.paymentDate.errors && form.controls.paymentDate.touched
      "
    >
      <div *ngIf="form.controls.paymentDate.errors?.['required']">
        A data é requerida
      </div>
    </div>

    <ion-item class="custom-input" lines="none">
      <ion-select fill="clear" formControlName="paid" label="Pagado">
        <ion-select-option
          *ngFor="let paidOption of paidOptions"
          [value]="paidOption.value"
          >{{ paidOption.label }}</ion-select-option
        >
      </ion-select>
    </ion-item>
    <div
      class="validator"
      *ngIf="form.controls.paid.errors && form.controls.paid.touched"
    >
      <div *ngIf="form.controls.paid.errors?.['required']">
        O pagamento é requerido
      </div>
    </div>

    <ion-button
      mode="md"
      class="ion-margin"
      type="submit"
      [disabled]="form.invalid"
    >
      {{titleName}}
      <ion-icon
        slot="end"
        name="add-circle-outline"
      ></ion-icon>
    </ion-button>
  </form>
</ion-content>
